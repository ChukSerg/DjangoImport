# IMPORT FROM EXCEL TO DJANGO
#### Описание
Программа для импорта больших таблиц Excel в базу данных.
#### Технологии
- Python 3.10
- Django 4.2.3
- PostgreSQL 2.0.16
- django-import-export 3.2.0
#### Запуск проекта в dev-режиме
- Клонируйте репозиторий https://github.com/ChukSerg/DjangoImport с помощью команды
````
git clone
````
- Перейдите в папку проекта
- Установите и активируйте виртуальное окружение
- Установите зависимости из файла requirements.txt с помощью команды
````
pip install -r requirements.txt
````
Создайте базу данных в PostgresSQL.
Создайте и заполнить файл .env. (либо воспользоваться подсказкой из файла env.example, переименовав его в .env)
```
DB_ENGINE=django.db.backends.postgresql
DB_NAME= # название БД
POSTGRES_USER= # ваше имя пользователя
POSTGRES_PASSWORD= # пароль для доступа к БД
DB_HOST=127.0.0.1
DB_PORT=5432
```
В корневом каталоге выполните последовательно команды
```
python manage.py migrate
python manage.py createsuperuser   -  следуйте вопросам терминала, создайте суперюзера
```
Выполните запуск приложения с помощью команды
```
python manage.py runserver
```
Откройте в браузере страницу 
```
http://127.0.0.1:8000/admin
```
Войдите через созданного пользователя
Выберите модель Рекламные щиты (Boards)
Нажмите кнопку "Импорт"
Выберите нужный файл, выберите расширение файла. Нажмите кнопку "Отправить" (Перед отправкой проверьте свой Excel файл)
Подтвердите импорт
#### Проверка файла excel
````
1. Выделите ячейку внутри таблицы, нажмите Ctrl+End. Если выделилась нижняя правая ячейка, файл готов к импорту.
2. Если выделилась ячейка без данных, нужно удалить лишние ячейки. Например, последняя ячейка с данными G25:
- Выберите все столбцы справа от столбца G . Для этого активизируйте любую ячейку в столбце Н , нажмите Ctrl+Пробел, затем Shift+End и в конце, удерживая нажатой Shift, нажмите клавишу →.
- Выполните команду Главная → Ячейки → Удалить → Удалить столбцы с листа (или щелкните правой кнопкой мыши на заголовке любого столбца и выберите команду Удалить)
- Выделите все строки ниже строки 25. Для этого активизируйте любую ячейку в строке 26. Нажмите Shift+Пробел, затем Shift+End и в конце, удерживая нажатой Shift, нажмите клавишу ↓
- Выполните команду Главная → Ячейки → Удалит → Удалить строки с листа(или щелкните правой кнопкой мыши на заголовке любой строки и выберите команду Удалить)
- Сохраните книгу, и Excel переопределит последнюю ячейку
3. Проверьте последнюю ячейку. Нажатие Ctrl+End должно привести в правую нижнюю ячейку. Если это не так повторите шаг 2
4. Если вместо гиперссылок в ячейке отображается строковое значение, создайте макрос из файла macros. Выполните его - содержимое ячеек перезапишется на гиперссылку
5. Возможна ошибка - несрабатывание UniqueConstraints. Выдает ошибку (get() returned more than one Boards -- it returned 2!). В таблице отфильтровать ячейку с "Вн. код", если есть 2 значения, то к одному в конец кода добавить 1. Сохранить таблицу, повторить импорт.
````

### Авторы
Сергей Чукин
